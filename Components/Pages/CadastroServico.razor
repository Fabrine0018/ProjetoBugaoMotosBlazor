@page "/CadastroServico"
@rendermode InteractiveServer

@using AppBugaoMotoFVLE.Components.Models;
@inject ServicoDAO servicoDAO;
@inject NavigationManager Navigation;

@if (erro != null)

{
<div class="alert alert-danger">
    @erro
</div>
}
<ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/"> Início </a> </li> <!-- Inicio é Home-->
    <li class="breadcrumb-item active"> <a class="active"> Cadastrar: <span> Servico </span> </a></li>
</ol>

<div class="border p-4 rounded bg-white">


    <div class="borda-esquerda">
        <h3>Cadastro do serviço</h3>
        <p>Preencha todas as informações corretamente</p>
    </div>
    <EditForm Model="_novoServico" OnSubmit="Salvar">
        <input @bind-value="_novoServico!.Nome" type="text" placeholder="Nome do serviço">
    <div class="row">
            <div><input @bind-value="_novoServico!.Codigo"  type="text" placeholder="Código"></div>
            <div><input @bind-value="_novoServico!.Prestador" type="text" placeholder="Prestador"></div>
            <div><input @bind-value="_novoServico!.Valor"  type="text" placeholder="Valor do Serviço"></div>
    </div>

        <input rows="4" placeholder="Descrição">
    <div class="buttons">
        <button type="submit" class="btn-salvar">Salvar</button>
        <button class="btn-deletar">Deletar</button>
    </div>
    </EditForm>
</div>

@code {
    private string? erro = null;
    [SupplyParameterFromForm]
    private Servico? _novoServico { get; set; } = new Servico();

    private void Salvar()
    {
        try
        {
            if (_novoServico.Prestador is null || _novoServico.Prestador == "")
            {

                throw new Exception("O campo Prestador é obrigatório");

            }
            servicoDAO.InserirServico(_novoServico);
            Navigation.NavigateTo("/ConsultaServico");

        }
        catch (Exception ex)
        {
            erro = ex.Message;
        }

    }
}
