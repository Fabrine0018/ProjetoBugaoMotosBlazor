@page "/Atualizar-Fornecedor-{Id:int}"
@rendermode InteractiveServer

@using AppBugaoMotoFVLE.Components.Models;
@inject FornecedorDAO fornecedorDao;
@inject NavigationManager Navigation;

@if (!string.IsNullOrEmpty(erro))
{
    <div class="alert alert-danger">@erro</div>
}

<div class="container-md pt-3">

    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/"> Início </a> </li> <!-- Inicio é Home-->
        <li class="breadcrumb-item"> <a href="/ConsultaFornecedor"> Consultar: Fornecedor </a></li>
        <li class="breadcrumb-item active"> <a class="active"> Atualizar: <span> Fornecedor </span> </a></li>
    </ol>

    <div class=" border p-4 rounded bg-white">

        <div class="borda-esquerda">
            <h3>Editar Fornecedor</h3>
            <p>Preencha as informações que deseja editar</p>
        </div>

        <EditForm Model="fornecedor" OnSubmit="Salvar" FormName="AtualizarFornecedor">
            <div class="row">
                <div class="col-12 mb-3 mt-3">
                    <label class="mb-1">Nome do Fornecedor:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Nome" />
                </div>
            </div>

            <div class="row">
                <div class="col-12 mb-3 mt-3">
                    <label class="mb-1">Nome do Responsavel:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Responsavel" />
                </div>
            </div>

            <div class="row">
                <div class="col-6 mb-3">
                    <label class="mb-1">Telefone:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Telefone" />
                </div>

                <div class="col-6 mb-3">
                    <label class="mb-1">CNPJ:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.CNPJ" />
                </div>
            </div>

            <div class="row">
                <div class="col-6 mb-3">
                    <label class="mb-1">Cidade:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Cidade" />
                </div>

                <div class="col-6 mb-3">
                    <label class="mb-1">Estado:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Estado" />
                </div>
            </div>

            <div class="row">
                <div class="col-6 mb-3">
                    <label class="mb-1">Rua:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Rua" />
                </div>

                <div class="col-6 mb-3">
                    <label class="mb-1">Bairro:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Bairro" />
                </div>
            </div>

            <div class="row">
            <div class="col-6 mb-3">
                <label class="mb-1">Complemento:</label>
                    <input type="text" class="form-control" @bind-value="@fornecedor.Complemento" />
            </div>
          </div>

            <div class="row">
                <div class="buttons">
                    <button type="submit" class="btn-salvar">Salvar Edição </button>
                    <button class="btn-deletar">Cancelar</button>
          
                </div>
            </div>
        </EditForm>
    </div>
</div>

@code {

    private string erro = string.Empty;

    [Parameter] public int Id { get; set; }

    [SupplyParameterFromForm]

    private Fornecedor fornecedor { get; set; } = new Fornecedor();

    protected override void OnInitialized()
    {
        var _fornecedor = fornecedorDao.BuacarIdFone(Id);
        if (_fornecedor != null)
            fornecedor = _fornecedor;
        else
            erro = "Fornecedor não encontrado";
    }

    private void Salvar()
    {
        try
        {
            fornecedorDao.AtualizarForne(fornecedor);
            Navigation.NavigateTo("/ConsultaFornecedor");
        }
        catch (Exception ex)
        {
            erro = $"Erro ao salvar o fornecedor: {ex.Message}";
        }
    }
   
    private void Cancelar()
    {
        Navigation.NavigateTo("/ConsultaFornecedor");
    }
}
